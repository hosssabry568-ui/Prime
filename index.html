<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØµØ­Ù Ø§Ù„Ù†ÙˆØ± - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ 2026</title>
    <link rel="manifest" href="data:application/manifest+json;base64,ewogICJuYW1lIjogIm1vc2hhZi1hbG5vdXIiLAogICJzaG9ydF9uYW1lIjogIm1vc2hhZiIsCiAgInN0YXJ0X3VybCI6ICIuIiwKICAmZGlzcGxheSI6ICJzdGFuZGFsb25lIiwKICAiYmFja2dyb3VuZF9jb2xvciI6ICIjMDYyMTE1IiwKICAidGhlbWVfY29sb3ciOiAiIzA2MjExNSIsCiAgImljb25zIjogW3siInNyYyI6ICJodHRwczovL2Nkbi1pY29ucy1wbmcuZmxhdGljb24uY29tLzUxMi8yOTY0LzI5NjQ1MjMucG5nIiwgInR5cGUiOiAiaW1hZ2UvcG5nIiwgInR5cGUiOiAiaW1hZ2UvcG5nIiwgInNpemVzIjogIjUxMng1MTIifV0KfQ==">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Noto+Naskh+Arabic:wght@400;700&family=Reem+Kufi:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #062115; --secondary: #0b2b1d; --accent: #d4af37;
            --bg-body: #fdfcf6; --text-color: #062115; --card-bg: #ffffff;
            --transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .dark-mode {
            --primary: #020a06; --secondary: #04140e; --bg-body: #020a06;
            --text-color: #f1f1f1; --card-bg: #0b2b1d;
        }
        * { -webkit-tap-highlight-color: transparent; user-select: none; box-sizing: border-box; }
        html, body { height: 100%; margin: 0; padding: 0; }
        body {
            background-color: var(--bg-body); color: var(--text-color);
            font-family: 'Amiri', serif; transition: background 0.5s ease; overflow-x: hidden;
            background-image: url('https://www.transparenttextures.com/patterns/islamic-art.png');
        }
        #splash-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--primary); z-index: 10000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: opacity 1s ease;
        }
        .splash-logo { font-family: 'Reem Kufi'; font-size: 4em; color: var(--accent); animation: pulse 2s infinite; text-shadow: 0 0 20px rgba(212,175,55,0.5); }
        @keyframes pulse { 0%, 100% { transform: scale(1); opacity: 0.8; } 50% { transform: scale(1.1); opacity: 1; } }
        #custom-toast { position: fixed; top: 20px; left: 50%; transform: translateX(-50%) translateY(-200%); background: var(--primary); color: var(--accent); padding: 15px 40px; border-radius: 50px; border: 2px solid var(--accent); z-index: 9999; transition: var(--transition); font-weight: bold; box-shadow: 0 10px 30px rgba(0,0,0,0.5); text-align: center;}
        #custom-toast.show { transform: translateX(-50%) translateY(0); }
        header { background: linear-gradient(135deg, var(--primary), var(--secondary)); padding: 60px 20px; text-align: center; border-bottom: 5px solid var(--accent); }
        header h1 { font-family: 'Reem Kufi', sans-serif; font-size: 3.5em; color: var(--accent); margin: 0; }
        #home-screen { display: flex; flex-direction: column; min-height: 100vh; }
        .grid-container { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; padding: 30px 20px; margin-top: -40px; flex-grow: 1; }
        .main-card { background: var(--card-bg); border: 2px solid rgba(212,175,55,0.2); border-radius: 25px; padding: 35px 15px; text-align: center; transition: var(--transition); cursor: pointer; box-shadow: 0 15px 35px rgba(0,0,0,0.1); display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .main-card:active { transform: scale(0.9); }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .ayah-frame { animation: fadeInUp 0.4s ease forwards; background: var(--card-bg); margin: 15px; padding: 25px; border-radius: 20px; border-right: 8px solid var(--accent); box-shadow: 0 5px 15px rgba(0,0,0,0.05); transition: var(--transition); }
        .ayah-frame:active { transform: scale(0.95); }
        .quran-font { font-family: 'Noto Naskh Arabic', serif; font-size: 1.8em; }
        .ayah-num-gold { color: var(--accent); font-weight: bold; }
        #content-viewer { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg-body); z-index: 5000; overflow-y: auto; opacity: 0; transform: scale(0.95); transition: var(--transition); }
        #content-viewer.active { display: block; opacity: 1; transform: scale(1); }
        .nav-bar { position: sticky; top: 0; background: var(--primary); padding: 15px 20px; display: flex; align-items: center; border-bottom: 3px solid var(--accent); z-index: 100; }
        .btn-back { background: var(--accent); color: var(--primary); border: none; padding: 10px 25px; border-radius: 12px; font-weight: bold; cursor: pointer; }
        .sebha-circle { width: 220px; height: 220px; border-radius: 50%; margin: 30px auto; display: flex; align-items: center; justify-content: center; font-size: 3em; cursor: pointer; transition: all 0.1s; background: radial-gradient(circle at 30% 30%, #0b2b1d, #062115); color: #fff; border: 8px solid var(--accent); box-shadow: 0 15px 0 #04140e, 0 20px 30px rgba(0,0,0,0.4); position: relative; top: 0; }
        .sebha-circle:active { top: 10px; box-shadow: 0 5px 0 #04140e; }
        .floating-mode-btn { position: fixed; bottom: 30px; left: 30px; width: 60px; height: 60px; background: var(--accent); border-radius: 50%; display: flex; align-items: center; justify-content: center; z-index: 9999; cursor: pointer; }

        #auto-scroll-btn { position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; background: var(--primary); color: var(--accent); border: 2px solid var(--accent); border-radius: 50%; display: none; align-items: center; justify-content: center; z-index: 9999; cursor: pointer; font-size: 0.8em; text-align: center; font-weight: bold; }
        #speed-control { position: fixed; bottom: 100px; right: 35px; width: 50px; height: 150px; display: none; z-index: 9999; flex-direction: column; align-items: center; background: var(--primary); border-radius: 20px; border: 1px solid var(--accent); padding: 10px; }
        #speed-control input { appearance: slider-vertical; width: 10px; height: 100%; accent-color: var(--accent); }
    </style>
</head>
<body>

<div id="splash-screen"><div class="splash-logo">Ù…ØµØ­Ù Ø§Ù„Ù†ÙˆØ±</div><p style="color: white; margin-top: 20px; opacity: 0.7;">Ø¨ØµÙ…Ø© Ø¥ÙŠÙ…Ø§Ù†ÙŠØ© Ø±Ù‚Ù…ÙŠØ© 2026</p></div>
<div id="custom-toast"></div>
<div class="floating-mode-btn" onclick="toggleDarkMode()">ğŸŒ—</div>

<div id="speed-control"><input type="range" min="10" max="100" value="50" oninput="updateSpeed(this.value)"></div>
<div id="auto-scroll-btn" onclick="toggleAutoScroll()">Ù†Ø²ÙˆÙ„<br>ØªÙ„Ù‚Ø§Ø¦ÙŠ</div>

<div id="home-screen">
    <header><h1>Ù…ØµØ­Ù Ø§Ù„Ù†ÙˆØ±</h1><p>ØªØ·Ø¨ÙŠÙ‚Ùƒ Ø§Ù„Ø¥ÙŠÙ…Ø§Ù†ÙŠ Ø§Ù„Ù…ÙØ¶Ù„</p></header>
    <div class="grid-container">
        <div class="main-card" onclick="openMod('quran')"><i>ğŸ“–</i><b>Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</b></div>
        <div class="main-card" onclick="openMod('azkar')"><i>ğŸ“¿</i><b>Ø§Ù„Ø£Ø°ÙƒØ§Ø± ÙƒØ§Ù…Ù„Ø©</b></div>
        <div class="main-card" onclick="openMod('prayers')"><i>ğŸ•Œ</i><b>Ø§Ù„Ù…ÙˆØ§Ù‚ÙŠØª</b></div>
        <div class="main-card" onclick="openMod('tasbih')"><i>ğŸ”¢</i><b>Ø§Ù„Ø³Ø¨Ø­Ø©</b></div>
        <div class="main-card" onclick="openMod('reciters')"><i>ğŸ™ï¸</i><b>Ø§Ù„ØªÙ„Ø§ÙˆØ§Øª</b></div>
        <div class="main-card" onclick="openMod('names')"><i>âœ¨</i><b>Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù„Ù‡</b></div>
        <div class="main-card" style="grid-column: span 2;" onclick="openMod('khatma')"><i>ğŸŒŸ</i><b>Ø§Ù„Ø®ØªÙ…Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©</b></div>
        <div class="main-card" style="grid-column: span 2;" onclick="openMod('azan')"><i>ğŸ””</i><b>Ø§Ù„Ø£Ø°Ø§Ù† ÙˆØ§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª</b></div>
    </div>
</div>

<div id="content-viewer">
    <div class="nav-bar"><button class="btn-back" onclick="handleExit()">Ø±Ø¬ÙˆØ¹</button><h2 id="v-title" style="margin:0; flex-grow:1; text-align:center; color:var(--accent); font-family:'Reem Kufi';"></h2></div>
    <div id="v-body"></div>
</div>

<audio id="audio-player"></audio>
<audio id="azan-player" crossorigin="anonymous"></audio>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getDatabase, ref, set, onValue, get } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";
    import { getMessaging, onMessage } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-messaging.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBKc0Vu8e1WxyUTmd1dEpGgrKDNOQV9PsY",
        authDomain: "quranapp-9c312.firebaseapp.com",
        projectId: "quranapp-9c312",
        databaseURL: "https://quranapp-9c312-default-rtdb.firebaseio.com/",
        storageBucket: "quranapp-9c312.firebasestorage.app",
        messagingSenderId: "708147485092",
        appId: "1:708147485092:web:ce228b7a245a89f08b0931"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const messaging = getMessaging(app);

    // Ø±Ø¨Ø· Ø§Ù„Ø¯ÙˆØ§Ù„ Ø¨Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ© Ù„ØªØ´ØºÙŠÙ„Ù‡Ø§ Ù…Ù† HTML
    window.db = db;
    window.ref = ref;
    window.set = set;
    window.onValue = onValue;
    window.get = get;

    // Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª ÙˆØ§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…ÙØªÙˆØ­
    onMessage(messaging, (payload) => {
        showToast(`Ø¥Ø´Ø¹Ø§Ø±: ${payload.notification.title}`);
    });
</script>

<script>
    let quranXml = null, isScrolling = false, scrollInterval, scrollSpeed = 50, prayerTimes = null, countdownInterval;
    let selectedAzan = "https://download.tvquran.com/download/azan/TVQuran.com_Azan_01.mp3";

    fetch('quran-simple.xml').then(r => r.text()).then(d => { quranXml = new DOMParser().parseFromString(d, "text/xml"); }).catch(e => console.log("Offline Mode"));

    window.onload = () => { setTimeout(() => { document.getElementById('splash-screen').style.opacity = '0'; setTimeout(() => document.getElementById('splash-screen').style.display = 'none', 1000); }, 2000); updatePrayerData(); };

    const viewer = document.getElementById('content-viewer'), vBody = document.getElementById('v-body'), vTitle = document.getElementById('v-title'), audio = document.getElementById('audio-player'), toast = document.getElementById('custom-toast'), azanAudio = document.getElementById('azan-player');
    let sCount = 0;

    function toAr(n) { return n.toString().replace(/\d/g, d => "Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©"[d]); }
    function toggleDarkMode() { document.body.classList.toggle('dark-mode'); }
    function showToast(m) { toast.innerText = m; toast.classList.add('show'); setTimeout(() => toast.classList.remove('show'), 2000); }
    function updateSpeed(val) { scrollSpeed = 110 - val; if(isScrolling) { clearInterval(scrollInterval); startScrolling(); } }
    function toggleAutoScroll() {
        if(isScrolling) { clearInterval(scrollInterval); isScrolling = false; document.getElementById('auto-scroll-btn').innerHTML = "Ù†Ø²ÙˆÙ„<br>ØªÙ„Ù‚Ø§Ø¦ÙŠ"; showToast("ØªÙ… Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù"); }
        else { isScrolling = true; document.getElementById('auto-scroll-btn').innerHTML = "Ø¥ÙŠÙ‚Ø§Ù"; startScrolling(); showToast("Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø²ÙˆÙ„"); }
    }
    function startScrolling() { scrollInterval = setInterval(() => { viewer.scrollTop += 1; }, scrollSpeed); }

    function openMod(type) {
        viewer.style.display = 'block'; setTimeout(() => viewer.classList.add('active'), 10);
        if(type === 'quran') renderSurahList();
        if(type === 'tasbih') renderTasbih();
        if(type === 'prayers') renderPrayers();
        if(type === 'azkar') renderAzkar();
        if(type === 'reciters') renderReciters();
        if(type === 'names') renderNames();
        if(type === 'azan') renderAzanMod();
        if(type === 'khatma') renderKhatmaMod();
    }

    // Ø¥Ø¶Ø§ÙØ© ÙˆØ­Ø¯Ø© Ø§Ù„Ø®ØªÙ…Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ© (ØªØ¹Ø¯ÙŠÙ„ ØµØ§Ø±Ù…)
    function renderKhatmaMod() {
        vTitle.innerText = 'Ø§Ù„Ø®ØªÙ…Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©';
        vBody.innerHTML = `
            <div style="text-align:center; padding-top:50px;">
                <div style="font-size:2em; color:var(--text-color); margin-bottom:10px;">Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ù…Ø³Ù„Ù…ÙŠÙ† Ø­ÙˆÙ„ Ø§Ù„Ø¹Ø§Ù„Ù…:</div>
                <div style="font-size:6em; color:var(--accent); font-weight:bold;" id="global-counter">...</div>
                <p style="margin-bottom:40px;">Ø³ÙˆØ±Ø© ØªÙ… Ù‚Ø±Ø§Ø¡ØªÙ‡Ø§ Ø¬Ù…Ø§Ø¹ÙŠØ§Ù‹</p>
                <div class="sebha-circle" style="background:var(--accent); color:var(--primary);" onclick="incrementGlobalKhatma()">Ø£Ù†Ù‡ÙŠØª Ø³ÙˆØ±Ø©</div>
            </div>`;
        
        const countRef = window.ref(window.db, 'khatma_global/total');
        window.onValue(countRef, (snapshot) => {
            const data = snapshot.val() || 0;
            document.getElementById('global-counter').innerText = toAr(data);
        });
    }

    function incrementGlobalKhatma() {
        const countRef = window.ref(window.db, 'khatma_global/total');
        window.get(countRef).then((snapshot) => {
            const current = snapshot.val() || 0;
            window.set(countRef, current + 1);
            showToast("ØªÙ‚Ø¨Ù„ Ø§Ù„Ù„Ù‡ Ù…Ù†Ùƒ");
            if(navigator.vibrate) navigator.vibrate(100);
        });
    }

    function handleExit() {
        clearInterval(scrollInterval); clearInterval(countdownInterval); isScrolling = false;
        document.getElementById('auto-scroll-btn').style.display = 'none';
        document.getElementById('speed-control').style.display = 'none';
        if(vTitle.innerText.includes('Ø³ÙˆØ±Ø©') || vTitle.innerText.includes('ØªÙ„Ø§ÙˆØ©')) renderSurahList();
        else { viewer.classList.remove('active'); setTimeout(() => viewer.style.display = 'none', 500); }
        audio.pause();
    }

    async function renderSurahList() {
        vTitle.innerText = 'ÙÙ‡Ø±Ø³ Ø§Ù„Ø³ÙˆØ±';
        document.getElementById('auto-scroll-btn').style.display = 'none';
        document.getElementById('speed-control').style.display = 'none';
        let html = '<div class="grid-container" style="margin-top:0;">';
        if(quranXml) {
            const suras = quranXml.querySelectorAll('sura');
            suras.forEach(s => { html += `<div class="main-card" onclick="renderAyahs(${s.getAttribute('index')}, '${s.getAttribute('name')}')"><b>${s.getAttribute('name')}</b></div>`; });
        } else {
            try {
                const res = await fetch('https://api.alquran.cloud/v1/surah');
                const data = await res.json();
                data.data.forEach(s => { html += `<div class="main-card" onclick="renderAyahs(${s.number}, '${s.name}')"><b>${s.name}</b></div>`; });
            } catch(e) { html = '<p style="text-align:center; padding:50px;">ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„</p>'; }
        }
        vBody.innerHTML = html + '</div>';
    }

    async function renderAyahs(id, name) {
        vTitle.innerText = 'Ø³ÙˆØ±Ø© ' + name;
        document.getElementById('auto-scroll-btn').style.display = 'flex';
        document.getElementById('speed-control').style.display = 'flex';
        vBody.innerHTML = '<p style="text-align:center; padding:50px;">ØªØ­Ù…ÙŠÙ„...</p>';
        try {
            const [ar, tf] = await Promise.all([
                fetch(`https://api.alquran.cloud/v1/surah/${id}/ar.alafasy`),
                fetch(`https://api.alquran.cloud/v1/surah/${id}/ar.jalalayn`)
            ]);
            const arD = await ar.json(), tfD = await tf.json();
            let html = '';
            arD.data.ayahs.forEach((a, i) => {
                html += `<div class="ayah-frame" onclick="playSaut('${a.audio}', this)">
                            <div class="quran-font">${a.text} <span class="ayah-num-gold">ï´¿${toAr(a.numberInSurah)}ï´¾</span></div>
                            <div style="margin-top:15px; color:#2d6a4f; border-top:1px solid #eee; padding-top:10px;">${tfD.data.ayahs[i].text}</div>
                         </div>`;
            });
            vBody.innerHTML = html;
        } catch(e) {
            if(quranXml) {
                const sura = quranXml.querySelector(`sura[index="${id}"]`), ayahs = sura.querySelectorAll('aya');
                let fullText = '';
                ayahs.forEach(a => {
                    if(a.getAttribute('bismillah')) fullText += `<div style="text-align:center; display:block; margin-bottom:20px; color:var(--accent); font-weight:bold;">${a.getAttribute('bismillah')}</div>`;
                    fullText += `${a.getAttribute('text')} <span class="ayah-num-gold">ï´¿${toAr(a.getAttribute('index'))}ï´¾</span> `;
                });
                vBody.innerHTML = `<div class="ayah-frame"><div class="quran-font" style="text-align:justify; line-height:2.2;">${fullText}</div></div>`;
            }
        }
        viewer.scrollTo(0,0);
    }

    async function updatePrayerData() {
        try {
            const res = await fetch('https://api.aladhan.com/v1/timingsByCity?city=Cairo&country=Egypt&method=5');
            const data = await res.json();
            prayerTimes = data.data.timings;
        } catch(e) { console.log("Offline"); }
    }

    function renderAzanMod() {
        vTitle.innerText = 'Ø§Ù„Ø£Ø°Ø§Ù† ÙˆØ§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª';
        vBody.innerHTML = `
            <div style="padding:20px;">
                <div class="ayah-frame" style="text-align:center; background:var(--primary); color:var(--accent);">
                    <h3 id="next-n">Ø§Ù„ØµÙ„Ø§Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</h3>
                    <div id="timer" style="font-size:2.5em; font-family:monospace; font-weight:bold;">00:00:00</div>
                </div>
                <div class="grid-container" style="margin-top:20px; padding:0;">
                    <div class="main-card" onclick="setAzan('https://download.tvquran.com/download/azan/TVQuran.com_Azan_01.mp3', 'Ù…ÙƒØ©')">ğŸ•‹<b>Ù…ÙƒØ©</b></div>
                    <div class="main-card" onclick="setAzan('https://download.tvquran.com/download/azan/TVQuran.com_Azan_10.mp3', 'Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©')">ğŸ•Œ<b>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</b></div>
                    <div class="main-card" onclick="setAzan('https://download.tvquran.com/download/azan/TVQuran.com_Azan_15.mp3', 'Ø§Ù„Ù‚Ø¯Ø³')">ğŸ‡µğŸ‡¸<b>Ø§Ù„Ù‚Ø¯Ø³</b></div>
                    <div class="main-card" onclick="setAzan('https://download.tvquran.com/download/azan/TVQuran.com_Azan_02.mp3', 'Ù…ØµØ±')">ğŸ‡ªğŸ‡¬<b>Ù…ØµØ±</b></div>
                </div>
                <div style="display:flex; gap:10px; margin-top:15px;">
                    <button id="btn-play-azan" class="main-card" style="flex:1; background:var(--accent); color:var(--primary); font-weight:bold; border:none; padding:15px;" onclick="playAzanNow()">ğŸ”” ØªØ¬Ø±Ø¨Ø©</button>
                    <button class="main-card" style="flex:1; background:#8b0000; color:white; font-weight:bold; border:none; padding:15px;" onclick="stopAzan()">ğŸ›‘ Ø¥ÙŠÙ‚Ø§Ù</button>
                </div>
            </div>`;
        startCountdown();
    }

    function setAzan(url, name) {
        selectedAzan = url;
        azanAudio.src = url;
        azanAudio.load();
        showToast('ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø£Ø°Ø§Ù† ' + name);
    }

    function playAzanNow() {
        if(!azanAudio.src) azanAudio.src = selectedAzan;
        let playPromise = azanAudio.play();
        if (playPromise !== undefined) {
            playPromise.then(_ => {
                showToast("Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ´ØºÙŠÙ„...");
            }).catch(error => {
                azanAudio.load();
                azanAudio.play();
            });
        }
    }

    function stopAzan() {
        azanAudio.pause();
        azanAudio.currentTime = 0;
        showToast("ØªÙ… Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù");
    }

    function startCountdown() {
        const p = {Fajr:'Ø§Ù„ÙØ¬Ø±', Dhuhr:'Ø§Ù„Ø¸Ù‡Ø±', Asr:'Ø§Ù„Ø¹ØµØ±', Maghrib:'Ø§Ù„Ù…ØºØ±Ø¨', Isha:'Ø§Ù„Ø¹Ø´Ø§Ø¡'};
        if(countdownInterval) clearInterval(countdownInterval);
        countdownInterval = setInterval(() => {
            if(!prayerTimes || !document.getElementById('timer')) return;
            const now = new Date();
            let next = null;
            for(let k in p) {
                let t = new Date(); const [h,m] = prayerTimes[k].split(':');
                t.setHours(h,m,0); if(t > now) { next = {n:p[k], t:t}; break; }
            }
            if(!next) {
    const [h,m] = prayerTimes['Fajr'].split(':');
    let t = new Date();
    t.setDate(t.getDate()+1);
    t.setHours(h, m, 0);
    next = { n: 'Ø§Ù„ÙØ¬Ø±', t: t };
}
               
            
            if(!next) { let t = new Date(); t.setDate(t.getDate()+1); const [h,m] = prayerTimes['Fajr'].split(':'); t.setHours(h,m,0); next = {n:'Ø§Ù„ÙØ¬Ø±', t:t}; }
            let diff = next.t - now;
            let hh = Math.floor(diff/3600000), mm = Math.floor((diff%3600000)/60000), ss = Math.floor((diff%60000)/1000);
            document.getElementById('next-n').innerText = "Ø§Ù„ØµÙ„Ø§Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©: " + next.n;
            document.getElementById('timer').innerText = `${hh.toString().padStart(2,'0')}:${mm.toString().padStart(2,'0')}:${ss.toString().padStart(2,'0')}`;
        }, 1000);
    }

    function renderAzkar() {
        vTitle.innerText = 'Ø­ØµÙ† Ø§Ù„Ù…Ø³Ù„Ù…';
        const az = [
            {t:"Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­", d:"Ø£ØµØ¨Ø­Ù†Ø§ ÙˆØ£ØµØ¨Ø­ Ø§Ù„Ù…Ù„Ùƒ Ù„Ù„Ù‡ØŒ ÙˆØ§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ØŒ Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡ ÙˆØ­Ø¯Ù‡ Ù„Ø§ Ø´Ø±ÙŠÙƒ Ù„Ù‡."},
            {t:"Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡", d:"Ø£Ù…Ø³ÙŠÙ†Ø§ ÙˆØ£Ù…Ø³Ù‰ Ø§Ù„Ù…Ù„Ùƒ Ù„Ù„Ù‡ØŒ ÙˆØ§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ØŒ Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡ ÙˆØ­Ø¯Ù‡ Ù„Ø§ Ø´Ø±ÙŠÙƒ Ù„Ù‡."},
            {t:"Ø³ÙŠØ¯ Ø§Ù„Ø§Ø³ØªØºÙØ§Ø±", d:"Ø§Ù„Ù„Ù‡Ù… Ø£Ù†Øª Ø±Ø¨ÙŠ Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø£Ù†ØªØŒ Ø®Ù„Ù‚ØªÙ†ÙŠ ÙˆØ£Ù†Ø§ Ø¹Ø¨Ø¯ÙƒØŒ ÙˆØ£Ù†Ø§ Ø¹Ù„Ù‰ Ø¹Ù‡Ø¯Ùƒ ÙˆÙˆØ¹Ø¯Ùƒ Ù…Ø§ Ø§Ø³ØªØ·Ø¹Øª."},
            {t:"Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ù†ÙˆÙ…", d:"Ø¨Ø§Ø³Ù…Ùƒ Ø±Ø¨ÙŠ ÙˆØ¶Ø¹Øª Ø¬Ù†Ø¨ÙŠ ÙˆØ¨Ùƒ Ø£Ø±ÙØ¹Ù‡ØŒ ÙØ¥Ù† Ø£Ù…Ø³ÙƒØª Ù†ÙØ³ÙŠ ÙØ§Ø±Ø­Ù…Ù‡Ø§."},
            {t:"Ø¨Ø¹Ø¯ Ø§Ù„ØµÙ„Ø§Ø©", d:"Ø£Ø³ØªØºÙØ± Ø§Ù„Ù„Ù‡ (3 Ù…Ø±Ø§Øª)ØŒ Ø§Ù„Ù„Ù‡Ù… Ø£Ù†Øª Ø§Ù„Ø³Ù„Ø§Ù… ÙˆÙ…Ù†Ùƒ Ø§Ù„Ø³Ù„Ø§Ù…ØŒ ØªØ¨Ø§Ø±ÙƒØª ÙŠØ§ Ø°Ø§ Ø§Ù„Ø¬Ù„Ø§Ù„ ÙˆØ§Ù„Ø¥ÙƒØ±Ø§Ù…."},
            {t:"Ø§Ù„ØªØ³Ø¨ÙŠØ­", d:"Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù ÙˆÙØ¨ÙØ­ÙÙ…Ù’Ø¯ÙÙ‡Ù (100 Ù…Ø±Ø©)"},
            {t:"Ø§Ù„ØµÙ„Ø§Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¨ÙŠ", d:"Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ ØµÙÙ„ÙÙ‘ ÙˆÙØ³ÙÙ„ÙÙ‘Ù…Ù’ Ø¹ÙÙ„ÙÙ‰ Ù†ÙØ¨ÙÙŠÙÙ‘Ù†ÙØ§ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù (10 Ù…Ø±Ø§Øª)"}
        ];
        let h = '';
        az.forEach(a => { h += `<div class="ayah-frame"><h3>${a.t}</h3><div class="quran-font" style="font-size:1.3em">${a.d}</div></div>`; });
        vBody.innerHTML = h;
    }

    function renderNames() {
        vTitle.innerText = 'Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù„Ù‡ Ø§Ù„Ø­Ø³Ù†Ù‰';
        const names = ["Ø§Ù„Ø±Ø­Ù…Ù†", "Ø§Ù„Ø±Ø­ÙŠÙ…", "Ø§Ù„Ù…Ù„Ùƒ", "Ø§Ù„Ù‚Ø¯ÙˆØ³", "Ø§Ù„Ø³Ù„Ø§Ù…", "Ø§Ù„Ù…Ø¤Ù…Ù†", "Ø§Ù„Ù…Ù‡ÙŠÙ…Ù†", "Ø§Ù„Ø¹Ø²ÙŠØ²", "Ø§Ù„Ø¬Ø¨Ø§Ø±", "Ø§Ù„Ù…ØªÙƒØ¨Ø±", "Ø§Ù„Ø®Ø§Ù„Ù‚", "Ø§Ù„Ø¨Ø§Ø±Ø¦", "Ø§Ù„Ù…ØµÙˆØ±", "Ø§Ù„ØºÙØ§Ø±", "Ø§Ù„Ù‚Ù‡Ø§Ø±", "Ø§Ù„ÙˆÙ‡Ø§Ø¨", "Ø§Ù„Ø±Ø²Ø§Ù‚", "Ø§Ù„ÙØªØ§Ø­", "Ø§Ù„Ø¹Ù„ÙŠÙ…", "Ø§Ù„Ù‚Ø§Ø¨Ø¶", "Ø§Ù„Ø¨Ø§Ø³Ø·", "Ø§Ù„Ø®Ø§ÙØ¶", "Ø§Ù„Ø±Ø§ÙØ¹", "Ø§Ù„Ù…Ø¹Ø²", "Ø§Ù„Ù…Ø°Ù„", "Ø§Ù„Ø³Ù…ÙŠØ¹", "Ø§Ù„Ø¨ØµÙŠØ±", "Ø§Ù„Ø­ÙƒÙ…", "Ø§Ù„Ø¹Ø¯Ù„", "Ø§Ù„Ù„Ø·ÙŠÙ", "Ø§Ù„Ø®Ø¨ÙŠØ±", "Ø§Ù„Ø­Ù„ÙŠÙ…", "Ø§Ù„Ø¹Ø¸ÙŠÙ…", "Ø§Ù„ØºÙÙˆØ±", "Ø§Ù„Ø´ÙƒÙˆØ±", "Ø§Ù„Ø¹Ù„ÙŠ", "Ø§Ù„ÙƒØ¨ÙŠØ±", "Ø§Ù„Ø­ÙÙŠØ©", "Ø§Ù„Ù…Ù‚ÙŠØª", "Ø§Ù„Ø­Ø³ÙŠØ¨", "Ø§Ù„Ø¬Ù„ÙŠÙ„", "Ø§Ù„ÙƒØ±ÙŠÙ…", "Ø§Ù„Ø±Ù‚ÙŠØ¨", "Ø§Ù„Ù…Ø¬ÙŠØ¨", "Ø§Ù„ÙˆØ§Ø³Ø¹", "Ø§Ù„Ø­ÙƒÙŠÙ…", "Ø§Ù„ÙˆØ¯ÙˆØ¯", "Ø§Ù„Ù…Ø¬ÙŠØ¯", "Ø§Ù„Ø¨Ø§Ø¹Ø«", "Ø§Ù„Ø´Ù‡ÙŠØ¯", "Ø§Ù„Ø­Ù‚", "Ø§Ù„ÙˆÙƒÙŠÙ„", "Ø§Ù„Ù‚ÙˆÙŠ", "Ø§Ù„Ù…ØªÙŠÙ†", "Ø§Ù„ÙˆÙ„ÙŠ", "Ø§Ù„Ø­Ù…ÙŠØ¯", "Ø§Ù„Ù…Ø­ØµÙŠ", "Ø§Ù„Ù…Ø¨Ø¯Ø¦", "Ø§Ù„Ù…Ø¹ÙŠØ¯", "Ø§Ù„Ù…Ø­ÙŠÙŠ", "Ø§Ù„Ù…Ù…ÙŠØª", "Ø§Ù„Ø­ÙŠ", "Ø§Ù„Ù‚ÙŠÙˆÙ…", "Ø§Ù„ÙˆØ§Ø¬Ø¯", "Ø§Ù„Ù…Ø§Ø¬Ø¯", "Ø§Ù„ÙˆØ§Ø­Ø¯", "Ø§Ù„Ø£Ø­Ø¯", "Ø§Ù„ØµÙ…Ø¯", "Ø§Ù„Ù‚Ø§Ø¯Ø±", "Ø§Ù„Ù…Ù‚ØªØ¯Ø±", "Ø§Ù„Ù…Ù‚Ø¯Ù…", "Ø§Ù„Ù…Ø¤Ø®Ø±", "Ø§Ù„Ø£ÙˆÙ„", "Ø§Ù„Ø¢Ø®Ø±", "Ø§Ù„Ø¸Ø§Ù‡Ø±", "Ø§Ù„Ø¨Ø§Ø·Ù†", "Ø§Ù„ÙˆØ§Ù„ÙŠ", "Ø§Ù„Ù…ØªØ¹Ø§Ù„ÙŠ", "Ø§Ù„Ø¨Ø±", "Ø§Ù„ØªÙˆØ§Ø¨", "Ø§Ù„Ù…Ù†ØªÙ‚Ù…", "Ø§Ù„Ø¹ÙÙˆ", "Ø§Ù„Ø±Ø¤ÙˆÙ", "Ù…Ø§Ù„Ùƒ Ø§Ù„Ù…Ù„Ùƒ", "Ø°Ùˆ Ø§Ù„Ø¬Ù„Ø§Ù„ ÙˆØ§Ù„Ø¥ÙƒØ±Ø§Ù…", "Ø§Ù„Ù…Ù‚Ø³Ø·", "Ø§Ù„Ø¬Ø§Ù…Ø¹", "Ø§Ù„ØºÙ†ÙŠ", "Ø§Ù„Ù…ØºÙ†ÙŠ", "Ø§Ù„Ù…Ø§Ù†Ø¹", "Ø§Ù„Ø¶Ø§Ø±", "Ø§Ù„Ù†Ø§ÙØ¹", "Ø§Ù„Ù†ÙˆØ±", "Ø§Ù„Ù‡Ø§Ø¯ÙŠ", "Ø§Ù„Ø¨Ø¯ÙŠØ¹", "Ø§Ù„Ø¨Ø§Ù‚ÙŠ", "Ø§Ù„ÙˆØ§Ø±Ø«", "Ø§Ù„Ø±Ø´ÙŠØ¯", "Ø§Ù„ØµØ¨ÙˆØ±"];
        let html = '<div class="grid-container" style="margin-top:20px;">';
        names.forEach(n => { html += `<div class="main-card"><b>${n}</b></div>`; });
        vBody.innerHTML = html + '</div>';
    }

    function renderTasbih() {
        vTitle.innerText = 'Ø§Ù„Ø³Ø¨Ø­Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©';
        vBody.innerHTML = `<div style="text-align:center; padding-top:50px;"><div style="font-size:8em; color:var(--accent);" id="sc">${toAr(sCount)}</div><div class="sebha-circle" onclick="sCount++; document.getElementById('sc').innerText=toAr(sCount); if(sCount%33==0) showToast('Ø£Ø­Ø³Ù†Øª')">Ø³Ø¨Ù‘Ø­</div><button class="btn-back" style="margin-top:30px" onclick="sCount=0; document.getElementById('sc').innerText='Ù '">ØªØµÙÙŠØ±</button></div>`;
    }

    async function renderPrayers() {
        vTitle.innerText = 'Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø©';
        if(!prayerTimes) await updatePrayerData();
        const names = {Fajr:'Ø§Ù„ÙØ¬Ø±', Dhuhr:'Ø§Ù„Ø¸Ù‡Ø±', Asr:'Ø§Ù„Ø¹ØµØ±', Maghrib:'Ø§Ù„Ù…ØºØ±Ø¨', Isha:'Ø§Ù„Ø¹Ø´Ø§Ø¡'};
        let html = '<div style="padding:20px">';
        for(let k in names) { html += `<div class="main-card" style="display:flex; justify-content:space-between; margin-bottom:15px; padding:25px;"><span>${names[k]}</span><b>${toAr(prayerTimes[k])}</b></div>`; }
        vBody.innerHTML = html + '</div>';
    }

    function renderReciters() {
        vTitle.innerText = 'Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø§Ø±Ø¦';
        const q = [{n: "ÙŠØ§Ø³Ø± Ø§Ù„Ø¯ÙˆØ³Ø±ÙŠ", b: "https://server11.mp3quran.net/yasser/"}, {n: "Ù…Ø´Ø§Ø±ÙŠ Ø§Ù„Ø¹ÙØ§Ø³ÙŠ", b: "https://server8.mp3quran.net/afs/"}, {n: "Ø¹Ø¨Ø¯Ø§Ù„Ø¨Ø§Ø³Ø·", b: "https://server7.mp3quran.net/basit/"}, {n: "Ø§Ù„Ù…Ù†Ø´Ø§ÙˆÙŠ", b: "https://server10.mp3quran.net/minsh/"}];
        let h = '<div class="grid-container" style="margin-top:0;">';
        q.forEach(r => { h += `<div class="main-card" onclick="renderSurahsForReciter('${r.b}', '${r.n}')"><b>${r.n}</b></div>`; });
        vBody.innerHTML = h + '</div>';
    }

    async function renderSurahsForReciter(base, rName) {
        vTitle.innerText = 'ØªÙ„Ø§ÙˆØ© ' + rName;
        const res = await fetch('https://api.alquran.cloud/v1/surah');
        const d = await res.json();
        let h = '<div class="grid-container" style="margin-top:0;">';
        d.data.forEach(s => { h += `<div class="main-card" onclick="playFullSurah('${base}', ${s.number}, '${s.name}')"><b>${s.name}</b></div>`; });
        vBody.innerHTML = h + '</div>';
    }

    function playFullSurah(base, sNum, sName) { showToast("Ø¬Ø§Ø±ÙŠ ØªØ´ØºÙŠÙ„ " + sName); audio.src = `${base}${sNum.toString().padStart(3, '0')}.mp3`; audio.play(); }
    
    function playSaut(url, el) { 
        document.querySelectorAll('.ayah-frame').forEach(f => f.style.background = 'var(--card-bg)'); 
        el.style.background = '#fcf9e8'; 
        audio.src = url; 
        audio.play(); 
    }

    document.addEventListener('click', function unlockAudio() {
        audio.play().then(() => { audio.pause(); audio.currentTime = 0; });
        azanAudio.play().then(() => { azanAudio.pause(); azanAudio.currentTime = 0; });
        document.removeEventListener('click', unlockAudio);
    }, { once: true });
</script>
    <script>
  // ÙƒÙˆØ¯ Ø¥Ø¬Ø¨Ø§Ø± Ø§Ù„Ù…ØªØµÙØ­ Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø°Ù† ÙÙˆØ±Ø§Ù‹
  window.onload = function() {
    Notification.requestPermission().then(function(permission) {
      if (permission === 'granted') {
        alert('ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¨Ù†Ø¬Ø§Ø­ ÙŠØ§ Ù„ÙŠØ¯Ø±!');
      } else {
        alert('Ù…Ù† ÙØ¶Ù„Ùƒ ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù„ØªØµÙ„Ùƒ ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„ÙˆØ±Ø¯.');
      }
    });
  };
    </script>
</body>
</html>
